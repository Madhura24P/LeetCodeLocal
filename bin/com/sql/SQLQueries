Second Highest Sal:
select max(sal) from emp where sal< select max(sal) from emp;
select sal from
(salect sal,denserank over (order by sal desc) as rank from emp)
where rank=n;

sal greater than aavg
select * from emp where sal > (salect avg(sal) from emp)

duplicate records
select colName,count(*) from table group by colName having count(*)>1

common from 2 trables
select * ftom tb1 intersect select * from tb2

lasdt 10 rec
select * from emp order by empis desc limit 10;

last 5 highest sal
select * from emp oirder by sal desc limit 5;

total sal
saelect suim(sal)

emp with no manager
select * from emp wher managerId=null

dept with highest number of emp
select dept , count(*) from emp
group by dept
order by count(*) desc
limit 1;

count in each dept
select dept,count(*) from e 
group by dept;

employee with max sal each dept
select deptId,empId,sal
from e where sal =
(select max(sal) from e where deptId=e.deptId)

select person,address,name,city
from Employee e left join Address a
as on e.EmployeeId=a.EmployeeId;

select score,rank over(order by scores desc) as rank
from scores.

select email from Person
group by email having count(*)>1;

select name from Employee
where id in 
(select ManagerId from Employee 
group by ManagerId having count(*)>=5
);

select Top1 salary from
(select top 2 salary from Employee order by salary desc) 
order by salary asc; 

Custmoer max order
select cust_name
from ( select cust_name,count(*) as cnt
from orders group by cust_num) as e
order by e.cnt desc
limit 1;

big counteries
select name,population,area
from world
where area>=30000 or population>=25000;6

classes with more than 5 students
select class from courses
group by classes
having count(distinct student)>=5;

select actr,dir
from actordir
group by act,dir
having count(*)>=3;

select productid,sum(qty) as total
from sales
group by product9



Order of execution of SQL:
1.FROM Clause
2.WHERE Clause
3.GROUP By Clause
4.HAVING Clause
5.Select Clause
6.Distinct Clause
7.Order by clause
8.Limit/offset
